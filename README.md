# powershell-firewall
在Windows服务器放置公网后，一直存在来之海外和国内IP针对远程桌面和SQLServer数据库服务帐号密码的暴力破解。于是编写了一个Powershell脚本，通过分析系统安全日志，自动探测攻击来源的IP并加入到Windows防火墙中，从而达到了自动过滤暴力攻击的IP地址。
1.开启Windows防火墙
在开始菜单运行中，输入：fw.msc，打开防火墙管理程序，在所有区域启用防火墙规则。

2.创建防火墙入站规则
依次选择：入站规则–>新建规则。
名称必须为：MY BLACKLIST
操作：阻止
作用域：远程IP地址，选择“下列IP地址”，初始配置时必须填写一个IP。否则防火墙将阻止所有入站通讯。

将脚本中的10.1.1.20地址修改成远程访问的IP地址，防止将受信任的IP地址防火墙中，导致无法访问。完成在powershell中运行下载的脚本程序。
因系统默认只允许运行经过受信任数字签名后的代码，脚本可能无法正常运行，有两个解决方法：
1.调整powershell运行安全策略，信任所有本地powershell脚本。

#从网络上下载的脚本执行会提示需要签名
set-executionpolicy remotesigned
#如要恢复强制签名，使用下面的命令
# 验证所有的脚本的签名信息，验证不通过，拒绝执行。
set-executionpolicy AllSigned
2.创建自签名证书，对脚本进行签名。
